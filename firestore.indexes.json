{
  "_comment": "Firestore Composite Indexes - Updated for Epic 14d-v2 (2026-02-01)",
  "_note_1": "Story 14d-v2-1-5b-1: Added pendingInvitations indexes for invitation service",
  "_note_2": "Changelog TTL: sharedGroups/{groupId}/changelog collection uses _ttl field for 30-day auto-expiration",
  "_ttl_setup_required": "TTL policy must be enabled manually in Firebase Console: Firestore > Time-to-live policies > Add policy: Collection=changelog, Field=_ttl",
  "indexes": [
    {
      "_comment": "getInvitationByShareCode: shareCode + status",
      "collectionGroup": "pendingInvitations",
      "queryScope": "COLLECTION",
      "fields": [
        { "fieldPath": "shareCode", "order": "ASCENDING" },
        { "fieldPath": "status", "order": "ASCENDING" }
      ]
    },
    {
      "_comment": "checkDuplicateInvitation: groupId + invitedEmail + status",
      "collectionGroup": "pendingInvitations",
      "queryScope": "COLLECTION",
      "fields": [
        { "fieldPath": "groupId", "order": "ASCENDING" },
        { "fieldPath": "invitedEmail", "order": "ASCENDING" },
        { "fieldPath": "status", "order": "ASCENDING" }
      ]
    },
    {
      "_comment": "getInvitationsForEmail: invitedEmail + status",
      "collectionGroup": "pendingInvitations",
      "queryScope": "COLLECTION",
      "fields": [
        { "fieldPath": "invitedEmail", "order": "ASCENDING" },
        { "fieldPath": "status", "order": "ASCENDING" }
      ]
    }
  ],
  "fieldOverrides": [
    {
      "collectionGroup": "fcmTokens",
      "fieldPath": "token",
      "ttl": false,
      "indexes": [
        {
          "order": "ASCENDING",
          "queryScope": "COLLECTION"
        },
        {
          "order": "DESCENDING",
          "queryScope": "COLLECTION"
        },
        {
          "arrayConfig": "CONTAINS",
          "queryScope": "COLLECTION"
        },
        {
          "order": "ASCENDING",
          "queryScope": "COLLECTION_GROUP"
        }
      ]
    },
    {
      "collectionGroup": "pushSubscriptions",
      "fieldPath": "endpoint",
      "ttl": false,
      "indexes": [
        {
          "order": "ASCENDING",
          "queryScope": "COLLECTION"
        },
        {
          "order": "ASCENDING",
          "queryScope": "COLLECTION_GROUP"
        }
      ]
    }
  ]
}
