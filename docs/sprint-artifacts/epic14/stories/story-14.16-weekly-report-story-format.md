# Story 14.16: Weekly Report Story Format

**Status:** ready-for-dev
**Points:** 5
**Epic:** 14 - Core Implementation
**Dependencies:** Story 14.1 (Animation Framework), Story 14.9 (Swipe Time Navigation)

---

## Story

As a **user reviewing my weekly spending**,
I want **Instagram-style swipeable report cards**,
so that **I can quickly browse through my spending summary in an engaging format**.

## Acceptance Criteria

1. **ReportCard component** with full-screen card styling
2. **Swipeable carousel** with horizontal navigation between cards
3. **Weekly summary card** showing total spent, vs last week, top categories
4. **Category breakdown cards** - one card per major spending category
5. **Trend arrows** (‚Üë‚Üì‚Üí) with color coding for easy understanding
6. **Rosa-friendly format** - simple language, large numbers, clear indicators
7. **Progress dots** showing current position in card stack

## Tasks / Subtasks

- [ ] Task 1: Create ReportCard component (AC: #1)
  - [ ] Create `src/components/reports/ReportCard.tsx`
  - [ ] Full-screen card with centered content
  - [ ] Background color/gradient per card type
  - [ ] Large typography for key numbers

- [ ] Task 2: Create ReportCarousel component (AC: #2)
  - [ ] Create `src/components/reports/ReportCarousel.tsx`
  - [ ] Use useSwipeNavigation hook from 14.9
  - [ ] Handle card transitions with slide animation
  - [ ] Support keyboard navigation (left/right arrows)

- [ ] Task 3: Implement weekly summary card (AC: #3)
  - [ ] Total spent this week (large, prominent)
  - [ ] Comparison vs last week (arrow + percentage)
  - [ ] Top 3 categories with mini bars
  - [ ] Date range display

- [ ] Task 4: Create category breakdown cards (AC: #4)
  - [ ] One card per category with significant spending
  - [ ] Category icon and color
  - [ ] Amount and percentage of total
  - [ ] Trend vs previous week

- [ ] Task 5: Implement TrendArrow component (AC: #5)
  - [ ] Create `src/components/reports/TrendArrow.tsx`
  - [ ] ‚Üë (up, red) = spending increased
  - [ ] ‚Üì (down, green) = spending decreased
  - [ ] ‚Üí (neutral, gray) = no significant change
  - [ ] Include percentage change text

- [ ] Task 6: Ensure Rosa-friendly format (AC: #6)
  - [ ] Large, readable numbers (48px+ font)
  - [ ] Simple labels in Spanish
  - [ ] Colloquial language ("Subi√≥ harto" not "Increment√≥ 27%")
  - [ ] Clear color coding

- [ ] Task 7: Add progress dots (AC: #7)
  - [ ] Dot indicator showing current card
  - [ ] Positioned at bottom of carousel
  - [ ] Animate active dot

- [ ] Task 8: Write tests
  - [ ] Test card rendering
  - [ ] Test swipe navigation
  - [ ] Test data calculations
  - [ ] Test Rosa-friendly text

## Dev Notes

### Mockup Reference

**From reports.html:**
- Full-screen cards with gradient backgrounds
- Large numbers centered
- Swipe indicators at bottom
- Trend arrows with color coding

### Card Types

```typescript
type ReportCardType = 'summary' | 'category' | 'trend' | 'milestone';

interface ReportCard {
  type: ReportCardType;
  title: string;
  primaryValue: string;
  secondaryValue?: string;
  trend?: 'up' | 'down' | 'neutral';
  trendPercent?: number;
  color?: string;
}
```

### Weekly Summary Generation

```typescript
interface WeeklySummary {
  totalSpent: number;
  previousWeekSpent: number;
  trendPercent: number;
  topCategories: { name: string; amount: number; percent: number }[];
  dateRange: { start: Date; end: Date };
}

function generateWeeklySummary(transactions: Transaction[]): WeeklySummary {
  // Filter to current week
  // Calculate totals
  // Compare with previous week
  // Extract top categories
}
```

### Rosa-Friendly Language

**From voice-tone-guidelines.md:**

| Technical | Rosa-Friendly |
|-----------|---------------|
| "Increment√≥ 27%" | "Subi√≥ harto" |
| "Decreci√≥ 15%" | "Baj√≥ un poco" |
| "Sin cambios significativos" | "Igual que antes" |
| "Total gastado: $X" | "Esta semana: $X" |

### Trend Arrow Colors

```typescript
const TREND_COLORS = {
  up: '#ef4444',    // Red - spending increased (bad)
  down: '#22c55e',  // Green - spending decreased (good)
  neutral: '#6b7280', // Gray - no change
};
```

### Carousel Implementation

```tsx
<ReportCarousel
  cards={generateReportCards(weeklyData)}
  onCardChange={(index) => setCurrentCard(index)}
/>
```

### References

- [Source: docs/sprint-artifacts/epic14/tech-context-epic14.md#Story 14.10]
- [Source: docs/uxui/mockups/01_views/reports.html]
- [Source: docs/uxui/voice-tone-guidelines.md#Rosa-friendly alternatives]
- [Source: src/hooks/useSwipeNavigation.ts - From 14.9]

---

## Atlas Workflow Analysis

> üó∫Ô∏è This section was generated by Atlas workflow chain analysis

### Affected Workflows

- **Insight History Flow (#8)**: Reports extend insight browsing concept
- **Analytics Navigation Flow (#2)**: Reports are alternative analytics view

### Downstream Effects to Consider

- Reports view needs to be added to navigation
- May need new route and tab bar update
- Data needs to be pre-calculated for performance

### Testing Implications

- **Existing tests to verify:** Transaction aggregation tests
- **New scenarios to add:** Report generation, swipe navigation, Rosa-friendly text

### Workflow Chain Visualization

```
[14.9 Swipe Navigation] ‚Üí [THIS STORY: Weekly Reports] ‚Üí [Reports View in Nav]
```

---

## Dev Agent Record

### Agent Model Used

_To be filled by dev agent_

### Completion Notes List

_To be filled during implementation_

### File List

_To be filled during implementation_
