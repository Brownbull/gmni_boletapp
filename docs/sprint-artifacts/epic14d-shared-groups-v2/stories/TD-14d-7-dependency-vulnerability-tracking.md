# Tech Debt Story TD-14d-7: Dependency Vulnerability Monitoring

Status: ready-for-dev

> **Source:** ECC Code Review #5 (2026-02-03) on story 14d-v2-1-7e
> **Priority:** HIGH (security vulnerability)
> **Estimated Effort:** 1-2 hours
> **Risk:** LOW (dependency update, automated testing catches regressions)

## Story

As a **security-conscious developer**,
I want **critical dependency vulnerabilities tracked and resolved**,
So that **the application is not exposed to known security issues**.

## Problem Statement

`npm audit` reveals critical/high vulnerabilities in transitive dependencies:

```
@isaacs/brace-expansion  <2.0.1
Severity: critical
ReDoS (Regular Expression Denial of Service)
CVE: GHSA-7h2j-956f-4vf2
CWE-1333: Inefficient Regular Expression Complexity

esbuild  <0.25.0
Severity: moderate
Development server can be accessed by malicious website
CVE: GHSA-67mh-4wv8-2f99
(Development only - no production impact)
```

## Acceptance Criteria

1. **Given** `npm audit` output
   **When** run after this story
   **Then** no critical or high vulnerabilities exist

2. **Given** dependency updates
   **When** applied
   **Then** all tests pass

3. **Given** transitive dependencies
   **When** direct updates are not possible
   **Then** override or resolution is documented

4. **Given** ongoing vulnerability monitoring
   **When** new vulnerabilities are discovered
   **Then** GitHub Dependabot alerts are configured

## Tasks / Subtasks

- [ ] **Task 1: Assess Current Vulnerabilities**
  - [ ] 1.1: Run `npm audit` and document all findings
  - [ ] 1.2: Identify which are transitive vs direct dependencies
  - [ ] 1.3: Check if fixes are available upstream

- [ ] **Task 2: Apply Fixes**
  - [ ] 2.1: Run `npm audit fix` for automatic fixes
  - [ ] 2.2: For transitive dependencies, add `overrides` in package.json if needed:
    ```json
    "overrides": {
      "@isaacs/brace-expansion": "^2.0.1"
    }
    ```
  - [ ] 2.3: Run full test suite
  - [ ] 2.4: Run build to verify no regressions

- [ ] **Task 3: Configure Dependabot**
  - [ ] 3.1: Create/update `.github/dependabot.yml`
  - [ ] 3.2: Configure alerts for npm dependencies
  - [ ] 3.3: Set security update PRs to auto-create

- [ ] **Task 4: Document Accepted Risks**
  - [ ] 4.1: Document any vulnerabilities that cannot be fixed (e.g., waiting upstream)
  - [ ] 4.2: Add monitoring reminder to sprint planning checklist

## Dev Notes

### Current Vulnerabilities (2026-02-03)

| Package | Severity | CVE | Status |
|---------|----------|-----|--------|
| @isaacs/brace-expansion | CRITICAL | GHSA-7h2j-956f-4vf2 | Fix via override or upstream |
| esbuild (dev) | MODERATE | GHSA-67mh-4wv8-2f99 | Update vite when compatible |

### Package.json Override Pattern

```json
{
  "overrides": {
    "@isaacs/brace-expansion": "^2.0.1"
  }
}
```

**Note:** Overrides can cause compatibility issues. Test thoroughly.

### Dependabot Configuration

```yaml
# .github/dependabot.yml
version: 2
updates:
  - package-ecosystem: "npm"
    directory: "/"
    schedule:
      interval: "weekly"
    open-pull-requests-limit: 10
    groups:
      security:
        patterns:
          - "*"
        update-types:
          - "security"
```

### Tradeoff Analysis

| Factor | Do Now | Defer |
|--------|--------|-------|
| **Security** | ✅ Vulnerabilities addressed | ❌ Exposure continues |
| **Stability** | ⚠️ Override may cause issues | ✅ No change |
| **Testing** | ✅ Full test suite validates | - |
| **Compliance** | ✅ Clean audit for release | ❌ Open finding |
| **Urgency** | CRITICAL CVE = should fix | - |

**Recommendation:** Do now. Critical ReDoS vulnerability should be addressed before production deployment. The override approach is low risk with comprehensive test coverage.

### Dependencies

- None (standalone maintenance task)

### References

- [14d-v2-1-7e](./14d-v2-1-7e-delete-ui-security-rules.md) - Source of this tech debt item (ECC Review #5)
- [GHSA-7h2j-956f-4vf2](https://github.com/advisories/GHSA-7h2j-956f-4vf2) - brace-expansion CVE
- [GHSA-67mh-4wv8-2f99](https://github.com/advisories/GHSA-67mh-4wv8-2f99) - esbuild CVE
